<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Our Products</title>

    <link rel="stylesheet" href="css/cardbox.css" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/responsive.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js"></script>
  </head>
  <body>
    <div class="header_area">
      <header class="header_section">
        <div class="container-fluid">
          <nav class="navbar navbar-expand-lg custom_nav-container">
            <a class="navbar-brand" href="index.html">
              <span> MiZ2u </span>
            </a>
            <button
              class="navbar-toggler"
              type="button"
              data-toggle="collapse"
              data-target="#navbarSupportedContent"
              aria-controls="navbarSupportedContent"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class=""> </span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav">
                <li class="nav-item">
                  <a class="nav-link" href="index.html">Home</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="about.html"> About</a>
                </li>
                <li class="nav-item active">
                  <a class="nav-link" href="products.html">Our Products</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="costomer-peofile.html">Profile</a>
                </li>
                <li class="nav-item nav_login">
                  <a class="nav-link" href="login.html">Log In</a>
                </li>
              </ul>
              <div class="quote_btn-container">
                <a href="login.html" class="quote_btn"> Log In </a>
              </div>
            </div>
          </nav>
        </div>
      </header>
    </div>
    <section class="event_section layout_padding">
      <div class="container">
        <div class="heading_container">
          <h2>Our Products</h2>
          <p>
            World class coffee beverage only here! Please come and taste my menu
            & get freash.
          </p>
        </div>
      </div>
      <div class="prod_row">
        <div class="product-card">
          <div class="image-container">
            <img src="images/softTea.jpg" alt="Product Image" />
          </div>
          <div class="product-info">
            <div class="product-title">Creamy Coffee</div>
            <div class="product-price">RM 3.90</div>
            <a href="#" class="buy-button">Buy Now</a>
          </div>
        </div>
        <div class="product-card">
          <div class="image-container">
            <img src="images/mizuss coffee.jpg" alt="Product Image" />
          </div>
          <div class="product-info">
            <div class="product-title">Signature Mis2u Latte</div>
            <div class="product-price">RM 9.55</div>
            <a href="#" class="buy-button">Buy Now</a>
          </div>
        </div>
        <div class="product-card">
          <div class="image-container">
            <img src="images/black_cafe.jpg" alt="Product Image" />
          </div>
          <div class="product-info">
            <div class="product-title">Black Coffee</div>
            <div class="product-price">RM 6.30</div>
            <a href="#" class="buy-button">Buy Now</a>
          </div>
        </div>
        <div class="product-card">
          <div class="image-container">
            <img src="images/latte_ice.jpeg" alt="Product Image" />
          </div>
          <div class="product-info">
            <div class="product-title">Ice Latte</div>
            <div class="product-price">RM 12.30</div>
            <a href="#" class="buy-button">Buy Now</a>
          </div>
        </div>
        <div class="product-card">
          <div class="image-container">
            <img src="images/ice_matcha.jpg" alt="Product Image" />
          </div>
          <div class="product-info">
            <div class="product-title">Iced Matcha Latte</div>
            <div class="product-price">RM 12.45</div>
            <a href="#" class="buy-button">Buy Now</a>
          </div>
        </div>
        <div class="product-card">
          <div class="image-container">
            <img src="images/pission_tea.jpg" alt="Product Image" />
          </div>
          <div class="product-info">
            <div class="product-title">Iced Pission Tea</div>
            <div class="product-price">RM 13.05</div>
            <a href="#" class="buy-button">Buy Now</a>
          </div>
        </div>
        <div class="product-card">
          <div class="image-container">
            <img src="images/grape_soda.jpg" alt="Product Image" />
          </div>
          <div class="product-info">
            <div class="product-title">Grape Soda</div>
            <div class="product-price">RM 13.20</div>
            <a href="#" class="buy-button">Buy Now</a>
          </div>
        </div>
        <div class="product-card">
          <div class="image-container">
            <img src="images/peach_soda.webp" alt="Product Image" />
          </div>
          <div class="product-info">
            <div class="product-title">Peach Soda</div>
            <div class="product-price">RM 10.55</div>
            <a href="#" class="buy-button">Buy Now</a>
          </div>
        </div>
        <div class="product-card">
          <div class="image-container">
            <img src="images/green_milk_tea.avif" alt="Product Image" />
          </div>
          <div class="product-info">
            <div class="product-title">Green Milk Tea</div>
            <div class="product-price">RM 9.30</div>
            <a href="#" class="buy-button">Buy Now</a>
          </div>
        </div>
      </div>
    </section>

    <div class="footer_container">
      <section class="info_section">
        <div class="container">
          <div class="row">
            <div class="col-md-6 col-lg-3">
              <div class="info_detail">
                <h4>MiZ2u</h4>
                <p>
                  Do you know what MiZ2u means?<br />
                  A young boy was tried hard to be rich and get a successful in
                  Life. In that time, he left the girl that he loves so much.And
                  the name comes out when he miss her girl.
                </p>
              </div>
            </div>
            <div class="col-md-6 col-lg-2 mx-auto">
              <div class="info_link_box">
                <h4>Links</h4>
                <div class="info_links">
                  <a class="" href="index.html"> Home </a>
                  <a class="" href="about.html"> About </a>
                  <a class="" href="products.html"> Our Products </a>
                  <a class="" href="contact.html"> Contact Us </a>
                </div>
              </div>
            </div>
            <div class="col-md-6 col-lg-3">
              <h4>Subscribe</h4>
              <form action="#">
                <input type="text" placeholder="Enter email" />
                <button type="submit">Subscribe</button>
              </form>
            </div>
            <div class="col-md-6 col-lg-3 mb-0 ml-auto">
              <div class="info_contact">
                <h4>Address</h4>
                <div class="contact_link_box">
                  <a href="">
                    <i class="fa fa-map-marker" aria-hidden="true"></i>
                    <span
                      >Subang Bestari, Seksyen U4 40150 Shah Alam, Selangor,
                      Malaysia
                    </span>
                  </a>
                  <a href="">
                    <i class="fa fa-phone" aria-hidden="true"></i>
                    <span> Call +60 39398044 </span>
                  </a>
                  <a href="">
                    <i class="fa fa-envelope" aria-hidden="true"></i>
                    <span> customerservice#MiZ2u@gmail.com </span>
                  </a>
                </div>
              </div>
              <div class="info_social">
                <a href="">
                  <i class="fa fa-facebook" aria-hidden="true"></i>
                </a>
                <a href="">
                  <i class="fa fa-twitter" aria-hidden="true"></i>
                </a>
                <a href="">
                  <i class="fa fa-linkedin" aria-hidden="true"></i>
                </a>
                <a href="">
                  <i class="fa fa-instagram" aria-hidden="true"></i>
                </a>
              </div>
            </div>
          </div>
        </div>
      </section>

      <footer class="footer_section">
        <div class="container">
          <p>
            &copy; <span id="displayYear"></span> All Rights Reserved By
            <a href="https://html.design/">MiZ2u Cafe</a>
          </p>
        </div>
      </footer>
    </div>

    <script>
      // Update footer year
      document.getElementById('displayYear').textContent = new Date().getFullYear();
    
      // Fetch and apply discounts
      document.addEventListener('DOMContentLoaded', function() {
          console.log('Fetching discounts for products...');
          fetch('http://localhost:3000/api/discounts')
              .then(response => {
                  if (!response.ok) {
                      throw new Error('Network response was not ok: ' + response.status);
                  }
                  return response.json();
              })
              .then(discounts => {
                  console.log('Discounts received:', discounts);
                  const productCards = document.querySelectorAll('.product-card');
                  console.log('Found product cards:', productCards.length);
    
                  productCards.forEach(card => {
                      // Get product title from .product-title element
                      const titleElement = card.querySelector('.product-title');
                      const productTitle = titleElement ? titleElement.textContent.trim() : null;
    
                      // Get price from .product-price element (remove "RM" and trim)
                      const priceElement = card.querySelector('.product-price');
                      const priceText = priceElement ? priceElement.textContent.replace('RM', '').trim() : null;
                      const originalPrice = priceText ? parseFloat(priceText) : NaN;
    
                      console.log('Processing card:', { productTitle, originalPrice });
    
                      // Validate data
                      if (!productTitle || isNaN(originalPrice)) {
                          console.error('Invalid card data:', { productTitle, originalPrice });
                          return;
                      }
    
                      // Find matching discount
                      const discount = discounts.find(d => d.product_title === productTitle);
                      if (discount) {
                          console.log('Discount found for', productTitle, ':', discount);
                          const discountPercentage = parseFloat(discount.discount_percentage);
                          const discountedPrice = (originalPrice * (1 - discountPercentage / 100)).toFixed(2);
                          priceElement.innerHTML = `
                              <span style="text-decoration: line-through;">RM ${originalPrice.toFixed(2)}</span>
                              RM ${discountedPrice}
                              <span style="color: red;">(${discountPercentage}% OFF)</span>
                          `;
                      } else {
                          console.log('No discount found for', productTitle);
                      }
                  });
              })
              .catch(error => {
                  console.error('Error fetching discounts:', error);
              });
      });
    </script>
  </body>
</html>
